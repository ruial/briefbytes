<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="description" content="I always liked to play computer games. They are complex pieces of software. In the past most games had cheat codes, but nowadays it’s less common. As an engineer I like to see how things work, so let’">
<meta property="og:type" content="article">
<meta property="og:title" content="Game hacking on Linux">
<meta property="og:url" content="https://briefbytes.com/2019/Game-hacking-on-Linux/index.html">
<meta property="og:site_name" content="BRIEF BYTES">
<meta property="og:description" content="I always liked to play computer games. They are complex pieces of software. In the past most games had cheat codes, but nowadays it’s less common. As an engineer I like to see how things work, so let’">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/health-search.png">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/writes-to-health.png">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/memory-viewer.png">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/memory-viewer-pointer.png">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/pointer-scan.png">
<meta property="og:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/dissect.png">
<meta property="article:published_time" content="2019-07-20T15:00:00.000Z">
<meta property="article:modified_time" content="2022-01-05T21:40:30.600Z">
<meta property="article:author" content="Rui Almeida">
<meta property="article:tag" content="hacking">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="c">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://briefbytes.com/2019/Game-hacking-on-Linux/health-search.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/desktop.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/android.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple.png">
          
        
    
    
    <title>Game hacking on Linux</title>
    
    
<link rel="stylesheet" href="/css/style.css">

    
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    
    
    
      <link rel="alternate" href="/atom.xml" title="BRIEF BYTES" type="application/atom+xml">
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/ruial">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/Query-MongoDB-using-SQL-with-Presto/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li>
        
        
        <li><a class="icon" href="/2019/Debugging-mobile-apps-with-an-https-proxy/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li>
        
        <li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none">Previous post</span>
      <span id="i-next" class="info" style="display:none">Next post</span>
      <span id="i-top" class="info" style="display:none">Back to top</span>
      <span id="i-share" class="info" style="display:none">Share post</span>
    </span>
    <br>
    <div id="share" style="display:none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://briefbytes.com/2019/Game-hacking-on-Linux/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&text=Game hacking on Linux"><i class="fab fa-twitter" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&is_video=false&description=Game hacking on Linux"><i class="fab fa-pinterest" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Game hacking on Linux&body=Check out this article: https://briefbytes.com/2019/Game-hacking-on-Linux/"><i class="fas fa-envelope" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-get-pocket" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-reddit" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-stumbleupon" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-digg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&name=Game hacking on Linux&description="><i class="fab fa-tumblr" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://briefbytes.com/2019/Game-hacking-on-Linux/&t=Game hacking on Linux"><i class="fab fa-hacker-news" aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-are-game-hacks-made"><span class="toc-number">1.</span> <span class="toc-text">How are game hacks made</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cheat-Engine"><span class="toc-number">2.</span> <span class="toc-text">Cheat Engine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Searching-the-health"><span class="toc-number">2.1.</span> <span class="toc-text">Searching the health</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pointer-scan"><span class="toc-number">2.2.</span> <span class="toc-text">Pointer scan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dissect-data-structures"><span class="toc-number">2.3.</span> <span class="toc-text">Dissect data structures</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coding"><span class="toc-number">3.</span> <span class="toc-text">Coding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Closing-thoughts"><span class="toc-number">4.</span> <span class="toc-text">Closing thoughts</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Game hacking on Linux
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">BRIEF BYTES</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-07-20T15:00:00.000Z" itemprop="datePublished">2019-07-20</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/c/" rel="tag">c</a>, <a class="tag-link-link" href="/tags/hacking/" rel="tag">hacking</a>, <a class="tag-link-link" href="/tags/linux/" rel="tag">linux</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>I always liked to play computer games. They are complex pieces of software. In the past most games had cheat codes, but nowadays it’s less common. As an engineer I like to see how things work, so let’s reverse engineer an open-source game on Linux called <a target="_blank" rel="noopener" href="https://www.xonotic.org/">Xonotic</a> and create a small cheat to have infinite health and ammo.</p>
<h2 id="How-are-game-hacks-made"><a href="#How-are-game-hacks-made" class="headerlink" title="How are game hacks made"></a>How are game hacks made</h2><p>To completely understand how cheats are made, some knowledge about how programs and memory work is valuable. Most common operating systems allow processes to read and write memory on other processes, which can be used to cheat in games. Values such as health are often stored in dynamically allocated memory. This means that when the game is restarted, the memory address that keeps the health will change. However, there is always some static base address that points to the health address, we just have to follow the pointers using static offsets.</p>
<h2 id="Cheat-Engine"><a href="#Cheat-Engine" class="headerlink" title="Cheat Engine"></a>Cheat Engine</h2><p>The most popular tool to hack games is <a target="_blank" rel="noopener" href="https://www.cheatengine.org/">Cheat Engine</a>. It is an open-source memory scanner and debugger. As most games on PC are for Windows, that is the primary focus of the software. On Linux it uses a client-server architecture so we must download the Linux server and also the Windows client, which must be executed on <a target="_blank" rel="noopener" href="https://www.winehq.org/">Wine</a>.</p>
<h3 id="Searching-the-health"><a href="#Searching-the-health" class="headerlink" title="Searching the health"></a>Searching the health</h3><p>The first step is to start the cheat engine server using sudo and then the client. Afterwards connect to the server on <em>File &gt; Open Process &gt; Network &gt; Connect</em> and select the game process.</p>
<p>Now we can search for the health. Start with 100, scan, take a bit of damage, scan again until we have few addresses. Green addresses are static and finding them so soon usually means that it is not the address we want. Let’s try the other address and “Find out what writes to this address”.</p>
<img src="/2019/Game-hacking-on-Linux/health-search.png" title="Health search">

<p>A bit of assembly knowledge is useful. We can see that the <strong>mov</strong> instruction copies the value from the <strong>ecx</strong> register to the address we found. On the line above, the <strong>ecx</strong> value is copied from the <strong>rdi</strong> register, which contains the address <strong>0x7FFCE0634490</strong>. As <strong>rax</strong> is 0, the addition and multiplication do nothing.</p>
<img src="/2019/Game-hacking-on-Linux/writes-to-health.png" title="Writes to health">

<p>Let’s add the address we found and “Find out what accesses to this address” and we can see that many instructions access this address. Since the health is being copied from here, we will have to search all of them until we find some register with the value 100 (decimal), which will be 0x64 (hexadecimal). Luckily, I didn’t have to search a lot and then I clicked the “Show disassembler” to open the Memory viewer. In here we can place some breakpoints and debug the program.</p>
<p>This is very insightful! The <strong>cvttss2si</strong> instruction is used to convert floats to integers. Going back a little we find the <strong>lea</strong> instruction which is copying the health from the address in <strong>edx + rax * 4</strong>. With the multiplication we get our first offset, <strong>0x30 * 0x4 = 0xC0</strong>. The <strong>rdx</strong> is set based on <strong>rd12 + 08</strong>, which is <strong>0xBE4E988</strong>. We can verify this by adding the pointer and offset to the list of addresses and by setting the type to float.</p>
<img src="/2019/Game-hacking-on-Linux/memory-viewer.png" title="Memory viewer">

<p>Now we need to find out what accesses to this pointer. These steps of finding the base address may involve trial and error. Let’s pick the first instruction and we know from the <strong>mov</strong> instruction that the offset is <strong>rsi + 08</strong>, which equals <strong>0x18</strong>. The <strong>r14</strong> register has an address and by looking at an instruction above, it is obtained through <strong>rbx + 0x5C360</strong> and <strong>rbx</strong> is <strong>0x1E6AAA0</strong>. As this address is static, it is our base address to get to the health, by applying the correct offsets.</p>
<img src="/2019/Game-hacking-on-Linux/memory-viewer-pointer.png" title="Memory viewer pointer">

<h3 id="Pointer-scan"><a href="#Pointer-scan" class="headerlink" title="Pointer scan"></a>Pointer scan</h3><p>An alternative to this backtracking is when we find the real health address, we do a pointer scan. We see 2 different pointer paths, to pick the right one we can restart the game and see which still points to the health. The static base address with the offset <strong>0x18</strong> is the same as the one previously found but is getting calculated using the “xonotic-linux64-sdl” module address.</p>
<img src="/2019/Game-hacking-on-Linux/pointer-scan.png" title="Pointer scan">

<h3 id="Dissect-data-structures"><a href="#Dissect-data-structures" class="headerlink" title="Dissect data structures"></a>Dissect data structures</h3><p>To find the ammo, I took a quick shortcut. Usually games store the player data in a <strong>struct</strong> or a <strong>class</strong> and as such, it’s highly likely that the health and ammo are in close memory proximity. By using the <strong>Dissect data structures</strong> feature from the <em>Memory Viewer &gt; Tools &gt; Dissect data/structures &gt; Structures &gt; Define new structure</em> we find that the ammo is just a few bytes away from the health, with the value 15.</p>
<img src="/2019/Game-hacking-on-Linux/dissect.png" title="Dissect data structures">

<h2 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h2><p>To read and write memory from other processes we need to call APIs that depend on the operating system. For Linux we can use <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man2/ptrace.2.html">ptrace</a> or <a target="_blank" rel="noopener" href="https://linux.die.net/man/2/process_vm_readv">process_vm_readv</a> and <a target="_blank" rel="noopener" href="https://linux.die.net/man/2/process_vm_writev">process_vm_writev</a>. On Windows, the functions <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory">ReadProcessMemory</a> and <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory">WriteProcessMemory</a> are available. Alternatively, a module (.so/.dll) can be injected into the game to avoid using these APIs and enable direct memory access. The best language for these low level things is C or C++.</p>
<figure class="highlight c"><figcaption><span>Read and write memory helpers</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">read_addr</span><span class="params">(<span class="keyword">pid_t</span> pid, <span class="keyword">unsigned</span> <span class="keyword">long</span> addr, <span class="keyword">void</span> *buffer, <span class="keyword">size_t</span> size)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">local</span>[1];</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">remote</span>[1];</span></span><br><span class="line"></span><br><span class="line">  local[<span class="number">0</span>].iov_base = buffer;</span><br><span class="line">  local[<span class="number">0</span>].iov_len = size;</span><br><span class="line">  remote[<span class="number">0</span>].iov_base = (<span class="keyword">void</span> *)addr;</span><br><span class="line">  remote[<span class="number">0</span>].iov_len = size;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> process_vm_readv(pid, local, <span class="number">1</span>, remote, <span class="number">1</span>, <span class="number">0</span>) == size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">write_addr</span><span class="params">(<span class="keyword">pid_t</span> pid, <span class="keyword">unsigned</span> <span class="keyword">long</span> addr, <span class="keyword">void</span> *buffer, <span class="keyword">size_t</span> size)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">local</span>[1];</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">remote</span>[1];</span></span><br><span class="line"></span><br><span class="line">  local[<span class="number">0</span>].iov_base = buffer;</span><br><span class="line">  local[<span class="number">0</span>].iov_len = size;</span><br><span class="line">  remote[<span class="number">0</span>].iov_base = (<span class="keyword">void</span> *)addr;</span><br><span class="line">  remote[<span class="number">0</span>].iov_len = size;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> process_vm_writev(pid, local, <span class="number">1</span>, remote, <span class="number">1</span>, <span class="number">0</span>) == size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Using system calls is an expensive operation. As such, it is better to create a <strong>struct</strong> to hold the player information and read one bigger chunk of memory at once, than many small chunks. As we are getting to the dynamic player structure address by reading pointers through a static base address and offsets, the cheat will always work when the game is restarted, however these offsets may change when the game is updated. There are alternatives to get to the dynamic address that may resist game updates which are based on signature/AOB(array of bytes) scans.</p>
<figure class="highlight c"><figcaption><span>Memory structures, read struct and write health</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLAYER_OFFSET_1 0x1AC6E00</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLAYER_OFFSET_2 0x18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEALTH_OFFSET 0xC0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMMO_OFFSET 0xD8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">bool</span> health;</span><br><span class="line">  <span class="keyword">bool</span> ammo;</span><br><span class="line">&#125; Options;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">pid_t</span> pid;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">module</span>;</span><br><span class="line">  Options options;</span><br><span class="line">&#125; Game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span> _1[<span class="number">0xC0</span>];</span><br><span class="line">  <span class="keyword">float</span> health;  <span class="comment">// 0xC0</span></span><br><span class="line">  <span class="keyword">char</span> _2[<span class="number">0x14</span>]; <span class="comment">// 0xD8 - 0xC0 - 0x4(sizeof float)</span></span><br><span class="line">  <span class="keyword">float</span> ammo;    <span class="comment">// 0xD8</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">long</span> address;</span><br><span class="line">&#125; MyPlayer;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">readMyPlayer</span><span class="params">(Game game, MyPlayer *myPlayer)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">long</span> ptr;</span><br><span class="line">  <span class="keyword">if</span> (read_addr(game.pid, game.<span class="keyword">module</span> + PLAYER_OFFSET_1, &amp;ptr, <span class="keyword">sizeof</span>(ptr))) &#123;</span><br><span class="line">    <span class="keyword">if</span> (read_addr(game.pid, ptr + PLAYER_OFFSET_2, &amp;ptr, <span class="keyword">sizeof</span>(ptr))) &#123;</span><br><span class="line">      myPlayer-&gt;address = ptr;</span><br><span class="line">      <span class="keyword">return</span> read_addr(game.pid, ptr, myPlayer,</span><br><span class="line">                       <span class="keyword">sizeof</span>(MyPlayer) - <span class="keyword">sizeof</span>(myPlayer-&gt;address));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">writeHealth</span><span class="params">(Game game, MyPlayer myPlayer, <span class="keyword">float</span> value)</span> </span>&#123;</span><br><span class="line">  write_addr(game.pid, myPlayer.address + HEALTH_OFFSET, &amp;value, <span class="keyword">sizeof</span>(value));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Cheats are usually running in some infinite loop until they detect the game is not available. Sleep commands avoid hitting unnecessary 100% CPU usage. Global keyboard input detection to toggle features is helpful (code is OS dependent). An alternative to writing the health constantly, would be to patch the code that decreases it, like replacing a <strong>mov</strong> with <strong>nop</strong> instructions, which could be done by writing the correct bytes at the correct address.</p>
<figure class="highlight c"><figcaption><span>Main loop</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">open_game</span><span class="params">(Game *game)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> ((game-&gt;pid = find_pid(<span class="string">&quot;xonotic-linux64-sdl&quot;</span>)) == <span class="number">0</span>) &#123;</span><br><span class="line">    sleep_ms(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ((game-&gt;<span class="keyword">module</span> = module_addr(game-&gt;pid, <span class="string">&quot;xonotic-linux64-sdl&quot;</span>)) == <span class="number">0</span>) &#123;</span><br><span class="line">    sleep_ms(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;waiting for xonotic...\n&quot;</span>);</span><br><span class="line">  Game game;</span><br><span class="line">  open_game(&amp;game);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;pid: %d\n&quot;</span>, game.pid);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;xonotic-linux64-sdl module: %lx\n&quot;</span>, game.<span class="keyword">module</span>);</span><br><span class="line"></span><br><span class="line">  MyPlayer myPlayer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (readMyPlayer(game, &amp;myPlayer)) &#123;</span><br><span class="line">      manage_input(&amp;game);</span><br><span class="line">      <span class="keyword">if</span> (game.options.health) &#123;</span><br><span class="line">        writeHealth(game, myPlayer, <span class="number">150</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      printPlayer(myPlayer);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;not in arena\n&quot;</span>);</span><br><span class="line">      sleep_ms(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sleep_ms(<span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Keep in mind that this hack works for single player only. Server side software should keep their own health value for each player and as such we can’t change it, any local change will be visual only.</p>
<h2 id="Closing-thoughts"><a href="#Closing-thoughts" class="headerlink" title="Closing thoughts"></a>Closing thoughts</h2><p>Reverse engineering is hard. I admire the researchers who have to analyze software/malware in similar ways. Making complex cheats is also extremely time consuming. For example, we can draw enemies through walls or even automatically aim and shoot against them by reading their coordinates and applying some game/engine dependent math, but a lot of study is required.</p>
<p>The full source code is available on <a target="_blank" rel="noopener" href="https://github.com/ruial/linux-game-hack-example">GitHub</a>.</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display:none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/ruial">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display:none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-are-game-hacks-made"><span class="toc-number">1.</span> <span class="toc-text">How are game hacks made</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cheat-Engine"><span class="toc-number">2.</span> <span class="toc-text">Cheat Engine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Searching-the-health"><span class="toc-number">2.1.</span> <span class="toc-text">Searching the health</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pointer-scan"><span class="toc-number">2.2.</span> <span class="toc-text">Pointer scan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dissect-data-structures"><span class="toc-number">2.3.</span> <span class="toc-text">Dissect data structures</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Coding"><span class="toc-number">3.</span> <span class="toc-text">Coding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Closing-thoughts"><span class="toc-number">4.</span> <span class="toc-text">Closing thoughts</span></a></li></ol>
    </div>

    <div id="share-footer" style="display:none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://briefbytes.com/2019/Game-hacking-on-Linux/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&text=Game hacking on Linux"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&is_video=false&description=Game hacking on Linux"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Game hacking on Linux&body=Check out this article: https://briefbytes.com/2019/Game-hacking-on-Linux/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&title=Game hacking on Linux"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://briefbytes.com/2019/Game-hacking-on-Linux/&name=Game hacking on Linux&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://briefbytes.com/2019/Game-hacking-on-Linux/&t=Game hacking on Linux"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022
    Rui Almeida
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/ruial">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>



  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">$(function(){$(".highlight table").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{text:function(e){return Array.from(e.nextElementSibling.querySelectorAll(".code")).reduce((e,t)=>e+t.innerText+"\n","")}}).on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()})})</script>


<script src="/js/main.js"></script>





    <script type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-141298250-1","auto"),ga("send","pageview")</script>





    <script type="text/javascript">var disqus_shortname="briefbytes";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script>


</body>
</html>
